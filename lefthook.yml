pre-commit:
  commands:
    check-dupe-inputs:
      run: |
        if grep -Riq '_2": {' flake.lock
        then
          echo duplicate inputs detected in flake.lock
          printf "useful commands for finding dupes:\ngrep -Ri '_2\": {' flake.lock\nnix flake metadata | strip-ansi\n"
          exit 1
        fi
    gen-docs:
      run: |
        nix build .#docs
        cp -f ./result docs/options.md
        git add ./docs/options.md
        git update-index --add ./docs/options.md
    gitleaks:
      run: |
        gitleaks detect --verbose --redact
